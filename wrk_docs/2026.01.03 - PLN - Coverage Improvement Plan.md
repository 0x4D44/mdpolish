# Code Coverage Improvement Plan

**Goal:** Increase code coverage from 0% to >98%.

## Phase 0: Infrastructure Setup
**Objective:** Enable test execution and coverage reporting.
1.  Create `jest.config.js` configured for React Native + TypeScript.
2.  Update `package.json` with `test` and `test:cov` scripts.
3.  Create `__tests__/setup.ts` for global mocks (AsyncStorage, Expo modules).
4.  Verify environment with a simple "sanity check" test.

## Phase 1: Core Logic (Utilities & Hooks)
**Objective:** Secure the business logic. Target: ~60% Coverage.
1.  **Utilities:**
    - `src/utils/storage.ts`: Test save, load, remove, and error handling.
    - `src/utils/notifications.ts`: Mock `expo-av` and `expo-haptics` to verify call logic.
2.  **Hooks:**
    - `src/hooks/useTimer.ts`: Test state machine (idle -> running -> paused -> completed), countdown logic, and reset.
    - `src/hooks/useStorage.ts`: Test wrapper logic around async storage.
    - `src/hooks/useConfig.ts`: Test configuration updates and persistence.
    - `src/hooks/useSession.ts`: Test session accumulation and iteration logic.

## Phase 2: UI Components
**Objective:** Verify rendering and user interactions. Target: ~85% Coverage.
1.  **Presentational Components:**
    - `src/components/Timer.tsx`: Verify time formatting and visual states.
    - `src/components/Stats.tsx`: Verify text formatting.
    - `src/components/ProgressRing.tsx`: Verify SVG props calculation (if applicable).
2.  **Interactive Components:**
    - `src/components/Controls.tsx`: Test button callbacks for all states.
    - `src/components/Settings.tsx`: Test form inputs and modal visibility.

## Phase 3: Integration & Edge Cases
**Objective:** Full system verification. Target: >98% Coverage.
1.  **App Integration:**
    - `App.tsx`: Test provider wrapping and initial render.
2.  **Edge Cases:**
    - Error boundaries.
    - Corrupt storage data.
    - App state changes (background/foreground).

## Execution Strategy
- All tests will be placed in `__tests__` directories or co-located with source files (e.g., `src/hooks/__tests__`).
- We will use `jest --coverage` to validate progress after each phase.
